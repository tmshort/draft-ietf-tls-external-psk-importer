<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Importing External PSKs for TLS</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
/*]]>*/</style>
<meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions and Definitions">
<link href="#rfc.section.3" rel="Chapter" title="3 Overview">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Terminology">
<link href="#rfc.section.4" rel="Chapter" title="4 Key Import">
<link href="#rfc.section.5" rel="Chapter" title="5 Deprecating Hash Functions">
<link href="#rfc.section.6" rel="Chapter" title="6 Incremental Deployment">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Privacy Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements">
<link href="#rfc.appendix.B" rel="Chapter" title="B Addressing Selfie">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.26.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Benjamin, D. and C. Wood" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-tls-external-psk-importer-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-10-13" />
  <meta name="dct.abstract" content="This document describes an interface for importing external PSK (Pre-Shared Key) into TLS 1.3." />
  <meta name="description" content="This document describes an interface for importing external PSK (Pre-Shared Key) into TLS 1.3." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">tls</td>
<td class="right">D. Benjamin</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Google, LLC.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">C. Wood</td>
</tr>
<tr>
<td class="left">Expires: April 15, 2020</td>
<td class="right">Apple, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 13, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Importing External PSKs for TLS<br />
  <span class="filename">draft-ietf-tls-external-psk-importer-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes an interface for importing external PSK (Pre-Shared Key) into TLS 1.3.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 15, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions and Definitions</a>
</li>
<li>3.   <a href="#rfc.section.3">Overview</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Terminology</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Key Import</a>
</li>
<li>5.   <a href="#rfc.section.5">Deprecating Hash Functions</a>
</li>
<li>6.   <a href="#rfc.section.6">Incremental Deployment</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Privacy Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<ul><li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Addressing Selfie</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> supports pre-shared key (PSK) authentication, wherein PSKs can be established via session tickets from prior connections or externally via some out-of-band mechanism. The protocol mandates that each PSK only be used with a single hash function.  This was done to simplify protocol analysis. TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>, in contrast, has no such requirement, as a PSK may be used with any hash algorithm and the TLS 1.2 PRF. This means that external PSKs could possibly be re-used in two different contexts with the same hash functions during key derivation. Moreover, it requires external PSKs to be provisioned for specific hash functions.</p>
<p id="rfc.section.1.p.2">To mitigate these problems, external PSKs can be bound to a specific KDF and hash function when used in TLS 1.3, even if they are associated with a different hash function when provisioned.  This document specifies an interface by which external PSKs may be imported for use in a TLS 1.3 connection to achieve this goal. In particular, it describes how KDF-bound PSKs can be differentiated by the target (D)TLS protocol version and KDF for which the PSK will be used. This produces a set of candidate PSKs, each of which are bound to a specific target protocol and KDF. This expands what would normally have been a single PSK identity into a set of PSK identities. However, importantly, it requires no change to the TLS 1.3 key schedule.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#conventions-and-definitions" id="conventions-and-definitions">Conventions and Definitions</a>
</h1>
<p id="rfc.section.2.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#overview" id="overview">Overview</a>
</h1>
<p id="rfc.section.3.p.1">Key importers mirror the concept of key exporters in TLS in that they diversify a key based on some contextual information before use in a connection. In contrast to key exporters, wherein differentiation is done via an explicit label and context string, the key importer defined herein uses an optional context string along with a target protocol and KDF identifier to differentiate an external PSK into one or more PSKs for use.</p>
<p id="rfc.section.3.p.2">Imported keys do not require negotiation for use, as a client and server will not agree upon identities if not imported correctly. Thus, importers induce no protocol changes with the exception of expanding the set of PSK identities sent on the wire. Endpoints may incrementally deploy PSK importer support by offering non-imported keys for TLS versions prior to TLS 1.3. Non-imported and imported PSKs are distinct since their identities are different on the wire. See <a href="#rollout" class="xref">Section 6</a> for more details.</p>
<p id="rfc.section.3.p.3">Clients which import external keys TLS MUST NOT use these keys for any other purpose.  Moreover, each external PSK MUST be associated with at most one hash function.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p></p>

<ul>
<li>External PSK (EPSK): A PSK established or provisioned out-of-band, i.e., not from a TLS connection, which is a tuple of (Base Key, External Identity, Hash).</li>
<li>Base Key: The secret value of an EPSK.</li>
<li>External Identity: The identity of an EPSK.</li>
<li>Target protocol: The protocol for which a PSK is imported for use.</li>
<li>Target KDF: The KDF for which a PSK is imported for use.</li>
<li>Imported PSK (IPSK): A PSK derived from an EPSK, external identity, optional context string, and target protocol and KDF.</li>
<li>Imported Identity: The identity of an Imported PSK as sent on the wire.</li>
</ul>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#key-import" id="key-import">Key Import</a>
</h1>
<p id="rfc.section.4.p.1">A key importer takes as input an EPSK with external identity <samp>external_identity</samp> and base key <samp>epsk</samp>, as defined in <a href="#terminology" class="xref">Section 3.1</a>, along with an optional context, and transforms it into a set of PSKs and imported identities for use in a connection based on supported (target) protocols and KDFs. In particular, for each supported target protocol <samp>target_protocol</samp> and KDF <samp>target_kdf</samp>, the importer constructs an ImportedIdentity structure as follows:</p>
<pre>
struct {
   opaque external_identity&lt;1...2^16-1&gt;;
   opaque context&lt;0..2^16-1&gt;;
   uint16 target_protocol;
   uint16 target_kdf;
} ImportedIdentity;
</pre>
<p id="rfc.section.4.p.2">The list of <samp>target_kdf</samp> values is maintained by IANA as described in <a href="#IANA" class="xref">Section 9</a>. External PSKs MUST NOT be imported for versions of (D)TLS 1.2 or prior versions. See <a href="#rollout" class="xref">Section 6</a> for discussion on how imported PSKs for TLS 1.3 and non-imported PSKs for earlier versions co-exist for incremental deployment.</p>
<p id="rfc.section.4.p.3">ImportedIdentity.context MUST include the context used to derive the EPSK, if any exists.  For example, ImportedIdentity.context may include information about peer roles or identities to mitigate Selfie-style reflection attacks. See <a href="#mitigate-selfie" class="xref">Appendix B</a> for more details.  If the EPSK is a key derived from some other protocol or sequence of protocols, ImportedIdentity.context MUST include a channel binding for the deriving protocols <a href="#RFC5056" class="xref">[RFC5056]</a>.</p>
<p id="rfc.section.4.p.4">ImportedIdentity.target_protocol MUST be the (D)TLS protocol version for which the PSK is being imported. For example, TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> and QUICv1 <a href="#QUIC" class="xref">[QUIC]</a> use 0x0304. Note that this means future versions of TLS will increase the number of PSKs derived from an external PSK.</p>
<p id="rfc.section.4.p.5">An Imported PSK derived from an EPSK with base key &#8216;epsk&#8217; bound to this identity is then computed as follows:</p>
<pre>
   epskx = HKDF-Extract(0, epsk)
   ipskx = HKDF-Expand-Label(epskx, "derived psk",
                             Hash(ImportedIdentity), L)
</pre>
<p id="rfc.section.4.p.6">L is corresponds to the KDF output length of ImportedIdentity.target_kdf as defined in <a href="#IANA" class="xref">Section 9</a>.  For hash-based KDFs, such as HKDF_SHA256(0x0001), this is the length of the hash function output, i.e., 32 octets. This is required for the IPSK to be of length suitable for supported ciphersuites.</p>
<p id="rfc.section.4.p.7">The identity of &#8216;ipskx&#8217; as sent on the wire is ImportedIdentity.</p>
<p id="rfc.section.4.p.8">The hash function used for HKDF <a href="#RFC5869" class="xref">[RFC5869]</a> is that which is associated with the EPSK.  It is not the hash function associated with ImportedIdentity.target_kdf. If no hash function is specified, SHA-256 MUST be used. Diversifying EPSK by ImportedIdentity.target_kdf ensures that an IPSK is only used as input keying material to at most one KDF, thus satisfying the requirements in <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<p id="rfc.section.4.p.9">Endpoints generate a compatible ipskx for each target ciphersuite they offer. For example, importing a key for TLS_AES_128_GCM_SHA256 and TLS_AES_256_GCM_SHA384 would yield two PSKs, one for HKDF-SHA256 and another for HKDF-SHA384. In contrast, if TLS_AES_128_GCM_SHA256 and TLS_CHACHA20_POLY1305_SHA256 are supported, only one derived key is necessary.</p>
<p id="rfc.section.4.p.10">The resulting IPSK base key &#8216;ipskx&#8217; is then used as the binder key in TLS 1.3 with identity ImportedIdentity. With knowledge of the supported KDFs, one may import PSKs before the start of a connection.</p>
<p id="rfc.section.4.p.11">EPSKs may be imported for early data use if they are bound to protocol settings and configurations that would otherwise be required for early data with normal (ticket-based PSK) resumption. Minimally, that means ALPN, QUIC transport settings, etc., must be provisioned alongside these EPSKs.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#deprecating-hash-functions" id="deprecating-hash-functions">Deprecating Hash Functions</a>
</h1>
<p id="rfc.section.5.p.1">If a client or server wish to deprecate a hash function and no longer use it for TLS 1.3, they remove the corresponding KDF from the set of target KDFs used for importing keys.  This does not affect the KDF operation used to derive Imported PSKs.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#rollout" id="rollout">Incremental Deployment</a>
</h1>
<p id="rfc.section.6.p.1">Recall that TLS 1.2 permits computing the TLS PRF with any hash algorithm and PSK.  Thus, an EPSK may be used with the same KDF (and underlying HMAC hash algorithm) as TLS 1.3 with importers. However, critically, the derived PSK will not be the same since the importer differentiates the PSK via the identity, target protocol, and target KDF. Thus, PSKs imported for TLS 1.3 are distinct from those used in TLS 1.2, and thereby avoid cross-protocol collisions. Note that this does not preclude endpoints from using non-imported PSKs for TLS 1.2. Indeed, this is necessary for incremental deployment.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The Key Importer security goals can be roughly stated as follows: avoid PSK re-use across KDFs while properly authenticating endpoints. When modeled as computational extractors, KDFs assume that input keying material (IKM) is sampled from some &#8220;source&#8221; probability distribution and that any two IKM values are chosen independently of each other <a href="#Kraw10" class="xref">[Kraw10]</a>. This source-independence requirement implies that the same IKM value cannot be used for two different KDFs.</p>
<p id="rfc.section.7.p.2">PSK-based authentication is functionally equivalent to session resumption in that a connection uses existing key material to authenticate both endpoints. Following the work of <a href="#BAA15" class="xref">[BAA15]</a>, this is a form of compound authentication. Loosely speaking, compound authentication is the property that an execution of multiple authentication protocols, wherein at least one is uncompromised, jointly authenticates all protocols.  Authenticating with an externally provisioned PSK, therefore, should ideally authenticate both the TLS connection and the external provision process. Typically, the external provision process produces a PSK and corresponding context from which the PSK was derived and in wihch it should be used. We refer to an external PSK without such context as &#8220;context free&#8221;.</p>
<p id="rfc.section.7.p.3">Thus, in considering the source-independence and compound authentication requirements, the Key Import API described in this document aims to achieve the following goals:</p>
<p></p>

<ol>
<li>Externally provisioned PSKs imported into TLS achieve compound authentication of the provision step(s) and connection.</li>
<li>Context-free PSKs only achieve authentication within the context of a single connection.</li>
<li>Imported PSKs are used as IKM for two different KDFs.</li>
<li>Imported PSKs do not collide with existing PSKs used for TLS 1.2 and below.</li>
<li>Imported PSKs do not collide with future protocol versions and KDFs.</li>
</ol>
<p id="rfc.section.7.p.5">[[ TODO: point to stable reference which describes the analysis of these goals ]]</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#privacy-considerations" id="privacy-considerations">Privacy Considerations</a>
</h1>
<p id="rfc.section.8.p.1">External PSK identities are typically static by design so that endpoints may use them to lookup keying material. However, for some systems and use cases, this identity may become a persistent tracking identifier.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.9.p.1">This specification introduces a new registry for TLS KDF identifiers and defines the following target KDF values:</p>
<p id="rfc.section.9.p.2">+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8211;+ | Description        | Value  | +&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8211;+ | Reserved           | 0x0000 | |                    |        | | HKDF_SHA256        | 0x0001 | |                    |        | | HKDF_SHA384        | 0x0002 | +&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8211;+</p>
<p id="rfc.section.9.p.3">New target KDF values are allocated according to the following process:</p>
<p></p>

<ul>
<li>Values in the range 0x0000-0xfeff are assigned via Specification Required <a href="#RFC8126" class="xref">[RFC8126]</a>.</li>
<li>Values in the range 0xff00-0xffff are reserved for Private Use <a href="#RFC8126" class="xref">[RFC8126]</a>.</li>
</ul>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="QUIC">[QUIC]</b></td>
<td class="top">
<a>Iyengar, J.</a> and <a>M. Thomson</a>, "<a href="https://tools.ietf.org/html/draft-ietf-quic-transport-23">QUIC: A UDP-Based Multiplexed and Secure Transport</a>", Internet-Draft draft-ietf-quic-transport-23, September 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5056">[RFC5056]</b></td>
<td class="top">
<a>Williams, N.</a>, "<a href="https://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>", RFC 5056, DOI 10.17487/RFC5056, November 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5869">[RFC5869]</b></td>
<td class="top">
<a>Krawczyk, H.</a> and <a>P. Eronen</a>, "<a href="https://tools.ietf.org/html/rfc5869">HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</a>", RFC 5869, DOI 10.17487/RFC5869, May 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6234">[RFC6234]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a> and <a>T. Hansen</a>, "<a href="https://tools.ietf.org/html/rfc6234">US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)</a>", RFC 6234, DOI 10.17487/RFC6234, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8126">[RFC8126]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Leiba, B.</a> and <a>T. Narten</a>, "<a href="https://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8446">[RFC8446]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc8446">The Transport Layer Security (TLS) Protocol Version 1.3</a>", RFC 8446, DOI 10.17487/RFC8446, August 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="BAA15">[BAA15]</b></td>
<td class="top">
<a>Bhargavan, K.</a>, <a>Delignat-Lavaud, A.</a> and <a>A. Pironti</a>, "<a>Verified Contributive Channel Bindings for Compound Authentication</a>", Proceedings 2015 Network and Distributed System Security Symposium, DOI 10.14722/ndss.2015.23277, 2015.</td>
</tr>
<tr>
<td class="reference"><b id="CCB">[CCB]</b></td>
<td class="top">
<a>Bhargavan, K.</a>, <a>Delignat-Lavaud, A.</a> and <a>A. Pironti</a>, "<a>Verified Contributive Channel Bindings for Compound Authentication</a>", Proceedings 2015 Network and Distributed System Security Symposium, DOI 10.14722/ndss.2015.23277, 2015.</td>
</tr>
<tr>
<td class="reference"><b id="Kraw10">[Kraw10]</b></td>
<td class="top">
<a>Krawczyk, H.</a>, "<a href="https://eprint.iacr.org/2010/264">Cryptographic Extraction and Key Derivation: The HKDF Scheme</a>", Proceedings of CRYPTO 2010 , 2010.</td>
</tr>
<tr>
<td class="reference"><b id="Selfie">[Selfie]</b></td>
<td class="top">
<a>Drucker, N.</a> and <a>S. Gueron</a>, "<a href="https://eprint.iacr.org/2019/347.pdf">Selfie: reflections on TLS 1.3 with PSK</a>", 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.A.p.1">The authors thank Eric Rescorla and Martin Thomson for discussions that led to the production of this document, as well as Christian Huitema for input regarding privacy considerations of external PSKs. John Mattsson provided input regarding PSK importer deployment considerations. Hugo Krawczyk provided guidance for the security considerations.</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#mitigate-selfie" id="mitigate-selfie">Addressing Selfie</a>
</h1>
<p id="rfc.section.B.p.1">The Selfie attack <a href="#Selfie" class="xref">[Selfie]</a> relies on a misuse of the PSK interface.  The PSK interface makes the implicit assumption that each PSK is known only to one client and one server. If multiple clients or multiple servers with distinct roles share a PSK, TLS only authenticates the entire group. A node successfully authenticates its peer as being in the group whether the peer is another node or itself.</p>
<p id="rfc.section.B.p.2">Applications which require authenticating finer-grained roles while still configuring a single shared PSK across all nodes can resolve this mismatch either by exchanging roles over the TLS connection after the handshake or by incorporating the roles of both the client and server into the IPSK context string. For instance, if an application identifies each node by MAC address, it could use the following context string.</p>
<pre>
  struct {
    opaque client_mac&lt;0..2^16-1&gt;;
    opaque server_mac&lt;0..2^16-1&gt;;
  } Context;
</pre>
<p id="rfc.section.B.p.3">If an attacker then redirects a ClientHello intended for one node to a different node, the receiver will compute a different context string and the handshake will not complete.</p>
<p id="rfc.section.B.p.4">Note that, in this scenario, there is still a single shared PSK across all nodes, so each node must be trusted not to impersonate another node&#8217;s role.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Benjamin</span> 
	  <span class="n hidden">
		<span class="family-name">Benjamin</span>
	  </span>
	</span>
	<span class="org vcardline">Google, LLC.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:davidben@google.com">davidben@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christopher A. Wood</span> 
	  <span class="n hidden">
		<span class="family-name">Wood</span>
	  </span>
	</span>
	<span class="org vcardline">Apple, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:cawood@apple.com">cawood@apple.com</a></span>

  </address>
</div>

</body>
</html>

